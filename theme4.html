<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Theme 4 ‚Äî Arts and Music</title>
  <style>
    body {
      font-family: Verdana, sans-serif;
      background: linear-gradient(180deg,#f0f3ff 0%,#d4ddff 100%);
      margin: 0;
      color: #002b5c;
      text-align: center;
    }
    header {
      background: linear-gradient(90deg,#003366,#4b5ed3);
      color: white;
      padding: 0.6rem 1rem;
      border-bottom: 5px solid #ffcc66;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo {
      width: 55px; height: 55px;
      border-radius: 50%;
      border: 3px solid #ffcc66;
      object-fit: cover;
      background: white;
    }
    h2 {color:#003366;}
    section {
      background: white;
      border-radius: 16px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      padding: 15px;
      max-width: 800px;
      margin: 15px auto;
      text-align: left;
      line-height: 1.5;
      font-size: 0.95rem;
    }
    h3 {
      background: #003366;
      color: white;
      padding: 6px 10px;
      border-radius: 8px;
      font-size: 1rem;
    }
    .btn {
      display:inline-block;
      margin:6px;
      padding:8px 14px;
      border:none;
      border-radius:10px;
      background:#003366;
      color:white;
      font-weight:bold;
      cursor:pointer;
      font-size:0.9rem;
    }
    .btn:hover {background:#ffcc66; color:#003366;}
    textarea {
      width:100%;
      border-radius:10px;
      border:1px solid #ccc;
      padding:6px;
      font-family:inherit;
      font-size:0.9rem;
    }
    input[type="text"] {
      width:100%;
      max-width:380px;
      border-radius:8px;
      border:1px solid #ccc;
      padding:4px 6px;
      font-family:inherit;
      font-size:0.9rem;
    }
    select {
      border-radius:8px;
      padding:2px 4px;
      font-size:0.9rem;
    }
  </style>
</head>
<body>
<header>
  <div style="display:flex;align-items:center;gap:10px;">
    <img src="logo.png" class="logo" alt="AI Bayan logo">
    <div>
      <h1 style="margin:0;font-size:1rem;">Theme 4 ‚Äî Arts and Music</h1>
      <p style="margin:0;color:#ffe9b5;">English with AI Bayan</p>
    </div>
  </div>
</header>

<main>
  <h2>üéµ Arts and Music</h2>
  <p style="font-style:italic;">Musical instruments and the museum</p>
  <p id="lessonStarsLine"><b>You have 0 ‚≠ê in this lesson.</b></p>

  <!-- ========== VOCABULARY (musical instruments) ========== -->
  <section>
    <h3>üß† VOCABULARY ‚Äî Musical instruments</h3>

    <p><b>AI Bayan –≥–æ–≤–æ—Ä–∏—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ. –†–µ–±—ë–Ω–æ–∫ –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–∏–π.</b></p>

    <!-- Q1 -->
    <p>1) AI Bayan:
      <button class="btn" onclick="speakVocab('The kobyz looks like a violin.')">‚ñ∂ Play</button>
      <button class="btn" onclick="stopBayan()">‚èπ Stop</button>
    </p>
    <p>Choose the correct translation:</p>
    <label><input type="radio" name="v1" value="1"> –ö–æ–±—ã–∑ –ø–æ—Ö–æ–∂ –Ω–∞ —Å–∫—Ä–∏–ø–∫—É.</label><br>
    <label><input type="radio" name="v1" value="0"> –ö–æ–±—ã–∑ –ø–æ—Ö–æ–∂ –Ω–∞ –≥–∏—Ç–∞—Ä—É.</label><br>
    <label><input type="radio" name="v1" value="0"> –ö–æ–±—ã–∑ –ø–æ—Ö–æ–∂ –Ω–∞ —Ç—Ä—É–±—É.</label><br>

    <!-- Q2 -->
    <p>2) AI Bayan:
      <button class="btn" onclick="speakVocab('The dombyra looks like a guitar.')">‚ñ∂ Play</button>
      <button class="btn" onclick="stopBayan()">‚èπ Stop</button>
    </p>
    <p>Choose the correct translation:</p>
    <label><input type="radio" name="v2" value="1"> –î–æ–º–±—ã—Ä–∞ –ø–æ—Ö–æ–∂–∞ –Ω–∞ –≥–∏—Ç–∞—Ä—É.</label><br>
    <label><input type="radio" name="v2" value="0"> –î–æ–º–±—ã—Ä–∞ –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Ñ–ª–µ–π—Ç—É.</label><br>
    <label><input type="radio" name="v2" value="0"> –î–æ–º–±—ã—Ä–∞ –ø–æ—Ö–æ–∂–∞ –Ω–∞ –±–∞—Ä–∞–±–∞–Ω.</label><br>

    <!-- Q3 -->
    <p>3) AI Bayan:
      <button class="btn" onclick="speakVocab('The sybyzgy looks like a flute.')">‚ñ∂ Play</button>
      <button class="btn" onclick="stopBayan()">‚èπ Stop</button>
    </p>
    <p>Choose the correct translation:</p>
    <label><input type="radio" name="v3" value="1"> –°—ã–±—ã–∑–≥—ã –ø–æ—Ö–æ–∂ –Ω–∞ —Ñ–ª–µ–π—Ç—É.</label><br>
    <label><input type="radio" name="v3" value="0"> –°—ã–±—ã–∑–≥—ã –ø–æ—Ö–æ–∂ –Ω–∞ –≥–∏—Ç–∞—Ä—É.</label><br>
    <label><input type="radio" name="v3" value="0"> –°—ã–±—ã–∑–≥—ã –ø–æ—Ö–æ–∂ –Ω–∞ —Ç—Ä—É–±—É.</label><br>

    <!-- Q4 -->
    <p>4) AI Bayan:
      <button class="btn" onclick="speakVocab('The dangyra looks like a drum.')">‚ñ∂ Play</button>
      <button class="btn" onclick="stopBayan()">‚èπ Stop</button>
    </p>
    <p>Choose the correct translation:</p>
    <label><input type="radio" name="v4" value="1"> –î–∞–Ω–≥—ã—Ä–∞ –ø–æ—Ö–æ–∂–∞ –Ω–∞ –±–∞—Ä–∞–±–∞–Ω.</label><br>
    <label><input type="radio" name="v4" value="0"> –î–∞–Ω–≥—ã—Ä–∞ –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Å–∫—Ä–∏–ø–∫—É.</label><br>
    <label><input type="radio" name="v4" value="0"> –î–∞–Ω–≥—ã—Ä–∞ –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Ñ–ª–µ–π—Ç—É.</label><br>

    <!-- Q5 -->
    <p>5) AI Bayan:
      <button class="btn" onclick="speakVocab('The uran looks like a trumpet.')">‚ñ∂ Play</button>
      <button class="btn" onclick="stopBayan()">‚èπ Stop</button>
    </p>
    <p>Choose the correct translation:</p>
    <label><input type="radio" name="v5" value="1"> –£—Ä–∞–Ω –ø–æ—Ö–æ–∂ –Ω–∞ —Ç—Ä—É–±—É.</label><br>
    <label><input type="radio" name="v5" value="0"> –£—Ä–∞–Ω –ø–æ—Ö–æ–∂ –Ω–∞ –±–∞—Ä–∞–±–∞–Ω.</label><br>
    <label><input type="radio" name="v5" value="0"> –£—Ä–∞–Ω –ø–æ—Ö–æ–∂ –Ω–∞ –ø–∏–∞–Ω–∏–Ω–æ.</label><br>

    <!-- Q6 -->
    <p>6) AI Bayan:
      <button class="btn" onclick="speakVocab('He is playing the piano and she is playing the drums.')">‚ñ∂ Play</button>
      <button class="btn" onclick="stopBayan()">‚èπ Stop</button>
    </p>
    <p>Choose the correct translation:</p>
    <label><input type="radio" name="v6" value="1"> –û–Ω –∏–≥—Ä–∞–µ—Ç –Ω–∞ –ø–∏–∞–Ω–∏–Ω–æ, –∞ –æ–Ω–∞ –∏–≥—Ä–∞–µ—Ç –Ω–∞ –±–∞—Ä–∞–±–∞–Ω–∞—Ö.</label><br>
    <label><input type="radio" name="v6" value="0"> –û–Ω –∏–≥—Ä–∞–µ—Ç –Ω–∞ –≥–∏—Ç–∞—Ä–µ, –∞ –æ–Ω–∞ —Ä–∏—Å—É–µ—Ç.</label><br>
    <label><input type="radio" name="v6" value="0"> –û–Ω –ø–æ—ë—Ç, –∞ –æ–Ω–∞ —Ç–∞–Ω—Ü—É–µ—Ç.</label><br>

    <button class="btn" onclick="checkVocab()">Check ‚úÖ</button>
    <div id="vocabStars" style="font-size:1.1rem;margin-top:8px;"></div>
  </section>

  <!-- ========== GRAMMAR (Present Continuous, questions, pronouns, articles) ========== -->
  <section>
    <h3>üìò GRAMMAR ‚Äî What are they doing?</h3>

    <p><b>1. Present Simple & Present Continuous:</b></p>
    <p>
      <b>Present Simple</b> ‚Äî habits, every day: <br>
      I play the guitar. / She sings every day. <br><br>
      <b>Present Continuous</b> ‚Äî now: <br>
      He is playing the piano now. / They are dancing now.
    </p>

    <p><b>Choose the correct form:</b></p>

    <p>1) Look! He ___ the violin now.</p>
    <label><input type="radio" name="q1" value="is playing"> is playing</label><br>
    <label><input type="radio" name="q1" value="plays"> plays</label><br>

    <p>2) She ___ the guitar every day.</p>
    <label><input type="radio" name="q2" value="plays"> plays</label><br>
    <label><input type="radio" name="q2" value="is playing"> is playing</label><br>

    <hr>

    <p><b>2. Wh-questions & object pronouns:</b></p>

    <p>3) ‚Äú___ is he doing?‚Äù ‚Äì ‚ÄúHe is playing the dombyra.‚Äù</p>
    <label><input type="radio" name="q3" value="what"> What</label><br>
    <label><input type="radio" name="q3" value="where"> Where</label><br>

    <p>4) ‚ÄúLook at ___! She is singing.‚Äù</p>
    <label><input type="radio" name="q4" value="her"> her</label><br>
    <label><input type="radio" name="q4" value="she"> she</label><br>

    <hr>

    <p><b>3. Articles (a / an / the):</b></p>

    <p>5) ___ kobyz looks like a violin.</p>
    <label><input type="radio" name="q5" value="the"> The</label><br>
    <label><input type="radio" name="q5" value="a"> A</label><br>

    <button class="btn" onclick="checkGrammar()">Check ‚úÖ</button>
    <div id="grammarStars" style="font-size:1.1rem;margin-top:8px;"></div>

    <p><b>4. Write your own sentence:</b> (practice)</p>
    <p>Example: The dombyra looks like a guitar.</p>
    <input id="writeGrammar" type="text" placeholder="Type your sentence here...">
  </section>

  <!-- ========== LISTENING (Museum text) ========== -->
  <section>
    <h3>üéß LISTENING ‚Äî The Museum of Kazakh Musical Instruments</h3>

    <p><b>1. Listen to AI Bayan:</b></p>
    <button class="btn" onclick="bayanListening()">‚ñ∂ Play</button>
    <button class="btn" onclick="stopBayan()">‚èπ Stop</button>

    <p style="margin-top:8px;font-size:0.9rem;color:#444;">
      (Teacher note: —Ç–µ–∫—Å—Ç –ø–æ Student‚Äôs Book.)
    </p>

    <p><b>2. True or False?</b></p>

    <p>1) The museum is in Astana.</p>
    <select id="t1">
      <option>‚Äî</option><option>True</option><option>False</option>
    </select>

    <p>2) The kobyz looks like a guitar.</p>
    <select id="t2">
      <option>‚Äî</option><option>True</option><option>False</option>
    </select>

    <p>3) The museum is in Panfilov Park.</p>
    <select id="t3">
      <option>‚Äî</option><option>True</option><option>False</option>
    </select>

    <button class="btn" onclick="checkListening()">Check ‚úÖ</button>
    <div id="listenStars" style="font-size:1.1rem;margin-top:8px;"></div>
  </section>

  <!-- ========== READING (text on screen + extra T/F) ========== -->
  <section>
    <h3>üìñ READING ‚Äî The Museum text</h3>

    <p><b>1. Read or listen:</b></p>
    <button class="btn" onclick="bayanReading()">‚ñ∂ Play</button>
    <button class="btn" onclick="stopBayan()">‚èπ Stop</button>

    <div style="margin-top:10px; background:#fdf7e6; border-radius:10px; padding:10px;">
      <p>
        The Museum of Kazakh Musical Instruments is in Almaty.  
        There are many musical instruments in this museum.  
        Some musical instruments from Kazakhstan look like those from other countries.  
        The kobyz looks like a violin, the dombyra like a guitar, the uran like a trumpet,  
        the sybyzgy like a flute, and the dangyra like a drum.  
        The museum is in Panfilov Park and is open Tuesday to Sunday from 10 a.m. to 7 p.m.
      </p>
    </div>

    <p><b>2. Answer the questions:</b></p>
    <ol>
      <li>Where is the Museum of Kazakh Musical Instruments?<br>
        <input id="r1" type="text" placeholder="Your answer..."></li><br>
      <li>Which instrument looks like a guitar?<br>
        <input id="r2" type="text" placeholder="Your answer..."></li><br>
      <li>When is the museum open?<br>
        <input id="r3" type="text" placeholder="Your answer..."></li>
    </ol>

    <button class="btn" onclick="checkReading()">Check ‚úÖ</button>
    <div id="readStars" style="font-size:1.1rem;margin-top:8px;"></div>
  </section>

  <!-- ========== SPEAKING ========== -->
  <section>
    <h3>üó£Ô∏è SPEAKING ‚Äî Talk about music</h3>

    <p><b>1. Listen to questions:</b></p>
    <button class="btn" onclick="bayanSpeaking()">‚ñ∂ Play</button>
    <button class="btn" onclick="stopBayan()">‚èπ Stop</button>

    <p style="margin-top:8px;"><b>Questions:</b></p>
    <ul>
      <li>What musical instrument do you like?</li>
      <li>Do you like singing or dancing?</li>
      <li>Would you like to visit the Museum of Kazakh Musical Instruments?</li>
    </ul>

    <p><b>2. Answer into the microphone:</b></p>
    <button class="btn" onclick="startSpeak()">üéô Start recording</button>
    <button class="btn" onclick="stopSpeak()">‚èπ Stop</button>

    <div id="speakStars" style="font-size:1.1rem;margin-top:10px;"></div>
  </section>

  <!-- ========== WRITING (translation + mini-poster) ========== -->
  <section>
    <h3>‚úçÔ∏è WRITING ‚Äî Translation & Music Fair</h3>

    <p><b>A. Translate into English:</b></p>
    <p>1) –ú–æ–π –ª—é–±–∏–º—ã–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ‚Äî –¥–æ–º–±—ã—Ä–∞.</p>
    <textarea id="w1" rows="2" placeholder="Your translation..."></textarea>

    <p>2) –í –º—É–∑–µ–µ –º–Ω–æ–≥–æ –∫–∞–∑–∞—Ö—Å–∫–∏—Ö –º—É–∑—ã–∫–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.</p>
    <textarea id="w2" rows="2" placeholder="Your translation..."></textarea>

    <p>3) –ö–æ–±—ã–∑ –ø–æ—Ö–æ–∂ –Ω–∞ —Å–∫—Ä–∏–ø–∫—É, –∞ –¥–∞–Ω–≥—ã—Ä–∞ –ø–æ—Ö–æ–∂–∞ –Ω–∞ –±–∞—Ä–∞–±–∞–Ω.</p>
    <textarea id="w3" rows="2" placeholder="Your translation..."></textarea>

    <button class="btn" onclick="checkWritingTranslate()">Check translation ‚úÖ</button>
    <div id="writeTransStars" style="font-size:1.1rem;margin-top:6px;"></div>

    <hr>

    <p><b>B. Write a mini-poster:</b></p>
    <p>Write a short invitation: <b>‚ÄúCome to the Music Fair!‚Äù</b> + When? Where?</p>
    <button class="btn" onclick="bayanPoster()">‚ñ∂ Example</button>
    <button class="btn" onclick="stopBayan()">‚èπ Stop</button>

    <textarea id="writeBox" rows="5" placeholder="Write your poster here..."></textarea><br>
    <button class="btn" onclick="checkPoster()">Check poster ‚úÖ</button>
    <div id="dictStars" style="font-size:1.1rem;margin-top:6px;"></div>
  </section>

  <!-- ========== LESSON RESULT ========== -->
  <section style="text-align:center;margin-top:25px;">
    <h3>üéØ Lesson Complete!</h3>
    <p>You have earned <b><span id="finalStars">0</span> ‚≠ê</b> in this lesson.</p>

    <button class="btn" onclick="finishLesson()">Save & Show Result ‚úÖ</button>

    <div id="finalMessage" style="margin-top:10px;font-size:1.1rem;color:#003366;"></div>

    <div style="margin-top:18px;">
      <button class="btn" onclick="goBack()">‚¨Ö Back</button>
      <button class="btn" onclick="goMenu()">üè† Main Menu</button>
      <button class="btn" onclick="goNext()">Next ‚û°Ô∏è</button>
    </div>
  </section>

  <p style="font-size:0.8rem;color:#444;margin-top:10px;text-align:center;">
    Created by Bayan team
  </p>
</main>

<script>
  // –û–ë–©–ò–ô –°–ß–Å–¢ –ó–í–Å–ó–î (–±–µ–∑ –ª–∏–º–∏—Ç–∞)
  let totalStars = 0;
  function addStar() {
    totalStars++;
    updateStarsText();
  }
  function updateStarsText(){
    document.getElementById('lessonStarsLine').innerText =
      "You have " + totalStars + " ‚≠ê in this lesson.";
    const fs = document.getElementById('finalStars');
    if(fs) fs.innerText = totalStars;
  }

  // –§–ª–∞–≥–∏, —á—Ç–æ–±—ã –Ω–µ –¥–∞–≤–∞—Ç—å –ø–æ 2 –∑–≤–µ–∑–¥—ã –∑–∞ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ—Ç–≤–µ—Ç
  const scored = {
    v1:false, v2:false, v3:false, v4:false, v5:false, v6:false,
    g1:false, g2:false, g3:false, g4:false, g5:false,
    l1:false, l2:false, l3:false,
    r1:false, r2:false, r3:false,
    w1:false, w2:false, w3:false,
    dict:false
  };

  // ---------- TTS (AI Bayan voice) ----------
  function speakBayanText(text){
    if(!('speechSynthesis' in window)){
      alert("–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–∑–≤—É—á–∫—É üòî");
      return;
    }
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "en-US";
    utter.rate = 0.9;
    utter.pitch = 1.05;
    utter.volume = 1;
    const voices = speechSynthesis.getVoices();
    const femaleEn = voices.find(v => v.lang.includes("en") && v.name.toLowerCase().includes("female"));
    if(femaleEn) utter.voice = femaleEn;
    speechSynthesis.speak(utter);
  }

  function stopBayan(){
    window.speechSynthesis.cancel();
  }

  // ---------- VOCABULARY ----------
  function speakVocab(text){
    speakBayanText(text);
  }

  function checkVocab(){
    let starsHere = 0;
    const q1 = document.querySelector('input[name="v1"]:checked');
    if(q1 && q1.value === "1" && !scored.v1){ scored.v1=true; addStar(); starsHere++; }
    const q2 = document.querySelector('input[name="v2"]:checked');
    if(q2 && q2.value === "1" && !scored.v2){ scored.v2=true; addStar(); starsHere++; }
    const q3 = document.querySelector('input[name="v3"]:checked');
    if(q3 && q3.value === "1" && !scored.v3){ scored.v3=true; addStar(); starsHere++; }
    const q4 = document.querySelector('input[name="v4"]:checked');
    if(q4 && q4.value === "1" && !scored.v4){ scored.v4=true; addStar(); starsHere++; }
    const q5 = document.querySelector('input[name="v5"]:checked');
    if(q5 && q5.value === "1" && !scored.v5){ scored.v5=true; addStar(); starsHere++; }
    const q6 = document.querySelector('input[name="v6"]:checked');
    if(q6 && q6.value === "1" && !scored.v6){ scored.v6=true; addStar(); starsHere++; }

    const box = document.getElementById('vocabStars');
    if(starsHere > 0){
      box.innerHTML = "‚≠ê +" + starsHere + " vocabulary stars!";
    } else {
      box.innerHTML = "No new stars. Check answers or you already got them.";
    }
  }

  // ---------- GRAMMAR ----------
  function checkGrammar(){
    let starsHere = 0;

    const q1 = document.querySelector('input[name="q1"]:checked');
    if(q1 && q1.value === "is playing" && !scored.g1){ scored.g1=true; addStar(); starsHere++; }

    const q2 = document.querySelector('input[name="q2"]:checked');
    if(q2 && q2.value === "plays" && !scored.g2){ scored.g2=true; addStar(); starsHere++; }

    const q3 = document.querySelector('input[name="q3"]:checked');
    if(q3 && q3.value === "what" && !scored.g3){ scored.g3=true; addStar(); starsHere++; }

    const q4 = document.querySelector('input[name="q4"]:checked');
    if(q4 && q4.value === "her" && !scored.g4){ scored.g4=true; addStar(); starsHere++; }

    const q5 = document.querySelector('input[name="q5"]:checked');
    if(q5 && q5.value === "the" && !scored.g5){ scored.g5=true; addStar(); starsHere++; }

    const box = document.getElementById('grammarStars');
    if(starsHere > 0){
      box.innerHTML = "‚≠ê +" + starsHere + " grammar stars!";
    } else {
      box.innerHTML = "No new stars. Check again or you already got them.";
    }
  }

  // ---------- LISTENING ----------
  function bayanListening(){
    const t = "The Museum of Kazakh Musical Instruments is in Almaty. " +
              "There are many musical instruments in this museum. " +
              "Some musical instruments from Kazakhstan look like those from other countries. " +
              "The kobyz looks like a violin, the dombyra like a guitar, " +
              "the uran like a trumpet, the sybyzgy like a flute, and the dangyra like a drum. " +
              "The museum is in Panfilov Park and is open Tuesday to Sunday from ten a.m. to seven p.m.";
    speakBayanText(t);
  }

  function checkListening(){
    let starsHere = 0;

    if(document.getElementById('t1').value === 'False' && !scored.l1){
      scored.l1 = true; addStar(); starsHere++;
    }
    if(document.getElementById('t2').value === 'False' && !scored.l2){
      scored.l2 = true; addStar(); starsHere++;
    }
    if(document.getElementById('t3').value === 'True' && !scored.l3){
      scored.l3 = true; addStar(); starsHere++;
    }

    const box = document.getElementById('listenStars');
    if(starsHere > 0){
      box.innerHTML = "‚≠ê +" + starsHere + " listening stars!";
    } else {
      box.innerHTML = "No new stars. Check your answers.";
    }
  }

  // ---------- READING ----------
  function bayanReading(){
    const t =
      "The Museum of Kazakh Musical Instruments is in Almaty. " +
      "There are many musical instruments in this museum. " +
      "Some musical instruments from Kazakhstan look like those from other countries. " +
      "The kobyz looks like a violin, the dombyra like a guitar, " +
      "the uran like a trumpet, the sybyzgy like a flute, and the dangyra like a drum. " +
      "The museum is in Panfilov Park and is open Tuesday to Sunday from ten a.m. to seven p.m.";
    speakBayanText(t);
  }

  function checkReading(){
    let starsHere = 0;
    const a1 = document.getElementById('r1').value.toLowerCase();
    const a2 = document.getElementById('r2').value.toLowerCase();
    const a3 = document.getElementById('r3').value.toLowerCase();

    if(!scored.r1 && (a1.includes("almaty"))){
      scored.r1 = true; addStar(); starsHere++;
    }
    if(!scored.r2 && (a2.includes("dombyra") || a2.includes("dombra"))){
      scored.r2 = true; addStar(); starsHere++;
    }
    if(!scored.r3 && (a3.includes("tuesday") || a3.includes("sunday") || a3.includes("10") || a3.includes("7"))){
      scored.r3 = true; addStar(); starsHere++;
    }

    const box = document.getElementById('readStars');
    if(starsHere > 0){
      box.innerHTML = "‚≠ê +" + starsHere + " reading stars!";
    } else {
      box.innerHTML = "No new stars. Check answers or you already got them.";
    }
  }

  // ---------- SPEAKING ----------
  let recognition;
  function bayanSpeaking(){
    const t = "Now let's talk about music. " +
              "What musical instrument do you like? " +
              "Do you like singing or dancing? " +
              "Would you like to visit the Museum of Kazakh Musical Instruments?";
    speakBayanText(t);
  }

  function startSpeak(){
    if(!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)){
      alert("Speech recognition is not supported in this browser.");
      return;
    }
    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    recognition = new SR();
    recognition.lang = "en-US";
    recognition.onresult = function(event){
      const speech = event.results[0][0].transcript.toLowerCase();
      let starsHere = 0;
      if(
        speech.includes("kobyz") || speech.includes("dombyra") || speech.includes("dombra") ||
        speech.includes("piano") || speech.includes("guitar") || speech.includes("drum") ||
        speech.includes("flute") || speech.includes("violin") ||
        speech.includes("sing") || speech.includes("dance") ||
        speech.includes("museum")
      ){
        addStar();
        starsHere++;
      }
      const box = document.getElementById('speakStars');
      if(starsHere > 0){
        box.innerHTML = "‚≠ê +" + starsHere + " speaking star!<br>You said: " + speech;
      } else {
        box.innerHTML = "You said: " + speech +
          "<br>Try to use words like: kobyz, dombyra, piano, sing, dance, museum...";
      }
    };
    recognition.start();
  }

  function stopSpeak(){
    if(recognition) recognition.stop();
  }

  // ---------- WRITING: TRANSLATION ----------
  function checkWritingTranslate(){
    let starsHere = 0;
    const a1 = document.getElementById('w1').value.toLowerCase();
    const a2 = document.getElementById('w2').value.toLowerCase();
    const a3 = document.getElementById('w3').value.toLowerCase();

    if(!scored.w1 &&
       a1.includes("my favourite") && a1.includes("musical instrument") &&
       (a1.includes("dombyra") || a1.includes("dombra"))){
      scored.w1 = true; addStar(); starsHere++;
    }

    if(!scored.w2 &&
       a2.includes("there are") && a2.includes("many") &&
       (a2.includes("kazakh musical instruments") || a2.includes("kazakh instruments"))){
      scored.w2 = true; addStar(); starsHere++;
    }

    if(!scored.w3 &&
       a3.includes("kobyz") && a3.includes("looks like a violin") &&
       (a3.includes("dangyra") || a3.includes("dangyra")) &&
       a3.includes("looks like a drum")){
      scored.w3 = true; addStar(); starsHere++;
    }

    const box = document.getElementById('writeTransStars');
    if(starsHere > 0){
      box.innerHTML = "‚≠ê +" + starsHere + " translation stars!";
    } else {
      box.innerHTML = "No new stars. Check your sentences or you already got them.";
    }
  }

  // ---------- WRITING: POSTER ----------
  function bayanPoster(){
    const t = "Come to the Music Fair! It is on Saturday at three o'clock in the school hall.";
    speakBayanText(t);
  }

  function checkPoster(){
    const text = document.getElementById("writeBox").value.toLowerCase();
    let found = 0;
    if(text.includes("come to the music fair")) found++;
    if(text.includes("when") || text.match(/\bsaturday\b|\bsunday\b|\bfriday\b/)) found++;
    if(text.includes("where") || text.includes("school") || text.includes("hall") || text.includes("park")) found++;

    let starsHere = 0;
    if(!scored.dict && found >= 2){
      scored.dict = true;
      addStar();
      starsHere++;
    }

    const box = document.getElementById('dictStars');
    if(starsHere > 0){
      box.innerHTML = "‚≠ê +" + starsHere + " writing star!";
    } else {
      box.innerHTML = "Try to write: 'Come to the Music Fair!' and add When? and Where?.";
    }
  }

  // ---------- FINISH + NAVIGATION ----------
  function finishLesson(){
    document.getElementById("finalStars").innerText = totalStars;
    let msg = "";
    if(totalStars >= 20){
      msg = "üåüüåüüåü Amazing! Music star!";
    } else if(totalStars >= 12){
      msg = "üåüüåü Great job! Very creative!";
    } else if(totalStars >= 6){
      msg = "üåü Good start! Keep practicing!";
    } else {
      msg = "Keep going! Every star is progress!";
    }
    document.getElementById("finalMessage").innerText = msg;

    const studentName = localStorage.getItem("studentName") || "Unknown Student";
    const allResults = JSON.parse(localStorage.getItem("teacherJournal") || "{}");
    allResults[studentName] = allResults[studentName] || {};
    allResults[studentName]["Lesson 4"] = totalStars;
    localStorage.setItem("teacherJournal", JSON.stringify(allResults));
    localStorage.setItem("lesson4Stars", totalStars);

    alert("Lesson 4 saved! " + studentName + " got " + totalStars + "‚≠ê.");
  }

  function goBack(){ window.location.href = "index.html"; }
  function goMenu(){ window.location.href = "index.html"; }
  function goNext(){ window.location.href = "theme5.html"; }

  // init
  updateStarsText();
</script>
  <!-- === Animation & Voice System === -->
<script>
// ====== ‚úÖ CORRECT / ‚ùå WRONG ANIMATION ======
function showResultAnimation(isCorrect, elementId){
  const el=document.getElementById(elementId);
  if(isCorrect){
    el.innerHTML="‚úÖ Correct! ‚≠ê";
    el.style.background="rgba(144,238,144,0.6)";
    el.style.border="2px solid green";
    el.style.transition="0.4s";
    setTimeout(()=>{ el.style.background=""; el.style.border=""; el.innerHTML=""; },1500);
  } else {
    el.innerHTML="‚ùå Try again!";
    el.style.background="rgba(255,182,193,0.6)";
    el.style.border="2px solid red";
    el.style.transition="0.4s";
    navigator.vibrate?.(250);
    setTimeout(()=>{ el.style.background=""; el.style.border=""; el.innerHTML=""; },1500);
  }
}

// ====== üó£Ô∏è AI Bayan Adaptive Voice ======
function bayanSpeak(text){
  const voices=speechSynthesis.getVoices();
  let voice=voices.find(v=>v.lang.includes("en-GB")||v.name.includes("Google UK English Female"));
  if(!voice){ voice=voices[0]; }
  const utter=new SpeechSynthesisUtterance(text);
  utter.voice=voice;
  utter.lang="en-GB";
  utter.rate=0.88;
  utter.pitch=1.0;
  speechSynthesis.speak(utter);
}
</script>
  <script>
// === üé® –¢–µ–º–∞ 4: Creative Melody (Arts and Music) ===
function setCustomColors() {
  const root = document.documentElement;

  // üíú –ê—Ä—Ç-–ø–∞–ª–∏—Ç—Ä–∞
  root.style.setProperty("--main-bg", "linear-gradient(180deg, #fbe9e7 0%, #f3e5f5 50%, #e1bee7 100%)");
  root.style.setProperty("--header-bg", "#7b1fa2");
  root.style.setProperty("--header-text", "#ffffff");
  root.style.setProperty("--btn-bg", "#8e24aa");
  root.style.setProperty("--btn-hover", "#ce93d8");
  root.style.setProperty("--text-color", "#4a0072");
  root.style.setProperty("--border-color", "#ba68c8");
  root.style.setProperty("--accent", "#ffb74d");

  // –ø—Ä–∏–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç–∞
  document.body.style.background = getComputedStyle(root).getPropertyValue("--main-bg");
  document.body.style.color = getComputedStyle(root).getPropertyValue("--text-color");
  document.querySelectorAll("header").forEach(h=>{
    h.style.background = getComputedStyle(root).getPropertyValue("--header-bg");
    h.style.color = getComputedStyle(root).getPropertyValue("--header-text");
  });
  document.querySelectorAll(".btn").forEach(btn=>{
    btn.style.background = getComputedStyle(root).getPropertyValue("--btn-bg");
    btn.onmouseenter = ()=>btn.style.background = getComputedStyle(root).getPropertyValue("--btn-hover");
    btn.onmouseleave = ()=>btn.style.background = getComputedStyle(root).getPropertyValue("--btn-bg");
  });
}

window.addEventListener("DOMContentLoaded", setCustomColors);
</script>
  <script>
// === üé® –¢–µ–º–∞ 5: Green Energy (Popular Team Sports) ===
function setCustomColors() {
  const root = document.documentElement;

  // üü¢ –°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –∑–µ–ª—ë–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞
  root.style.setProperty("--main-bg", "linear-gradient(180deg, #e8f5e9 0%, #c8e6c9 50%, #a5d6a7 100%)");
  root.style.setProperty("--header-bg", "#2e7d32");
  root.style.setProperty("--header-text", "#ffffff");
  root.style.setProperty("--btn-bg", "#388e3c");
  root.style.setProperty("--btn-hover", "#66bb6a");
  root.style.setProperty("--text-color", "#1b5e20");
  root.style.setProperty("--border-color", "#81c784");
  root.style.setProperty("--accent", "#ffd54f");

  // –ø—Ä–∏–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç–∞
  document.body.style.background = getComputedStyle(root).getPropertyValue("--main-bg");
  document.body.style.color = getComputedStyle(root).getPropertyValue("--text-color");
  document.querySelectorAll("header").forEach(h=>{
    h.style.background = getComputedStyle(root).getPropertyValue("--header-bg");
    h.style.color = getComputedStyle(root).getPropertyValue("--header-text");
  });
  document.querySelectorAll(".btn").forEach(btn=>{
    btn.style.background = getComputedStyle(root).getPropertyValue("--btn-bg");
    btn.onmouseenter = ()=>btn.style.background = getComputedStyle(root).getPropertyValue("--btn-hover");
    btn.onmouseleave = ()=>btn.style.background = getComputedStyle(root).getPropertyValue("--btn-bg");
  });
}

window.addEventListener("DOMContentLoaded", setCustomColors);
</script>
</body>
</html>




