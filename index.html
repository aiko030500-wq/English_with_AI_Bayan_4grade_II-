<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English with AI Bayan 4grade II</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#003366">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="apple-touch-icon" href="logo.png">

<style>
  body {
    font-family: Verdana, sans-serif;
    margin: 0;
    text-align: center;
    color: #002b5c;
    background: url("main-bg.png") center/cover fixed no-repeat;
  }

  header {
    background: rgba(0,51,102,0.95);
    color: white;
    padding: 1rem;
    border-bottom: 5px solid gold;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .header-title h1 {
    margin: 0;
    font-size: 1.3rem;
  }

  .girl-img {
    width: 90px;
    height: 90px;
    background: url("girl.png") center/cover no-repeat;
  }

  #teacherBanner {
    display: none;
    background: gold;
    color: #003366;
    padding: 10px;
    font-weight: bold;
    border-bottom: 3px solid #003366;
  }
  body.teacher-mode #teacherBanner { display: block; }

  main { padding: 1rem; }

  .btn {
    background:#003366; color:#fff;
    border:none; border-radius:10px;
    padding:8px 14px; font-weight:bold;
    cursor:pointer; margin:6px;
    transition:0.3s; font-size:0.9rem;
  }
  .btn:hover { background:gold; color:#003366; }

  .blue-install {
    position: fixed;
    bottom: 15px;
    left: 50%;
    transform: translateX(-50%);
    background: #003366;
    color: #fff;
    font-weight: bold;
    border: none;
    border-radius: 25px;
    padding: 12px 22px;
    font-size: 0.95rem;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    cursor: pointer;
    z-index: 1000;
  }
  .blue-install:hover { background: gold; color: #003366; }

  #welcomeBox {
    background:rgba(255,255,255,0.9);
    border-radius:16px;
    padding:10px 16px;
    max-width:500px;
    margin:10px auto 5px;
    border:2px solid gold;
  }

  .grid {
    display:grid;
    grid-template-columns:repeat(4, 1fr);
    gap:8px;
    max-width:700px;
    margin:15px auto;
  }
  .card {
    background:white;
    border:2px solid #dde6ff;
    border-radius:12px;
    padding:12px 5px;
    font-size:0.85rem;
    box-shadow:0 0 10px rgba(0,0,0,0.05);
    cursor:pointer;
  }
  .card:hover { border-color:gold; transform:scale(1.05); }

  #chatBox {
    background:#fff; border:2px solid gold;
    border-radius:10px; padding:10px;
    max-height:300px; overflow-y:auto; text-align:left;
  }

  table { border-collapse:collapse; margin:auto; font-size:0.85rem; }
  th, td { border:1px solid #ccc; padding:5px 8px; }
  th { background:#003366; color:white; }
</style>
</head>

<body>
<div id="teacherBanner">ğŸ‘©â€ğŸ« TEACHER MODE ACTIVE â€” unlimited questions</div>

<!-- ğŸ” LOGIN -->
<div class="overlay" id="loginOverlay">
  <div class="overlay-card">
    <h2>English with AI Bayan 4grade II</h2>
    <p style="font-size:0.9rem;">Enter your name and PIN:</p>
    <input type="text" id="nameInput" placeholder="Name">
    <input type="password" id="pinInput" placeholder="PIN" maxlength="4">
    <button class="btn" onclick="checkLogin()">Enter</button>
  </div>
</div>

<header>
  <div class="header-title">
    <h1>English with AI Bayan 4 grade II</h1>
  </div>
  <div class="girl-img"></div>
</header>

<main>
  <div id="welcomeBox" style="display:none;">
    <h2 id="welcomeText">Hello!</h2>
    <p>Total stars in all lessons: <b><span id="totalStars">0</span> â­</b></p>
  </div>

  <div id="mainMenu" style="display:none;">
    <div class="grid">
      <div class="card" onclick="openTheme(1)">ğŸ¨<br>Letâ€™s Have Fun!</div>
      <div class="card" onclick="openTheme(2)">ğŸƒ<br>Sports</div>
      <div class="card" onclick="openTheme(3)">ğŸŒ<br>Around the World</div>
      <div class="card" onclick="openTheme(4)">ğŸµ<br>Arts & Music</div>
      <div class="card" onclick="openTheme(5)">âš½<br>Team Sports</div>
      <div class="card" onclick="openTheme(6)">ğŸ»<br>Kazakh Museum</div>
      <div class="card" onclick="openTheme(7)">ğŸ“œ<br>Rights</div>
      <div class="card" onclick="openTheme(8)">ğŸ§°<br>Jobs</div>
      <div class="card" onclick="openTheme(9)">ğŸ‘©â€âš•ï¸<br>Professions</div>
      <div class="card" onclick="openTheme(10)">ğŸ¢<br>At Work</div>
      <div class="card" onclick="openTheme(11)">ğŸ’¬<br>Dialogues</div>
      <div class="card" onclick="openTheme(12)">â¤ï¸<br>You Can Help!</div>
      <div class="card" onclick="openTheme(13)">ğŸ¯<br>Final</div>
      <div class="card" onclick="openChat()">ğŸ’¬<br>AI Bayan</div>
      <div class="card" onclick="openTeacherJournal()">ğŸ«<br>Journal</div>
    </div>
  </div>
</main>

<!-- ğŸ”µ Ğ¡Ğ˜ĞĞ¯Ğ¯ ĞšĞĞĞŸĞšĞ -->
<button class="blue-install" id="installButton">â¬‡ï¸</button>

<script>
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  document.getElementById('installButton').style.display = 'block';
});
document.getElementById('installButton').addEventListener('click', async () => {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
  }
});

const allowedNames=["Aytach2","Aylin2","Alvi2","Zhahangir2","Narmin2","Balman2","Ilyas2","Dmitry2","Irada2","Shyngys2","Kiril2","Sultan2","Kira2","Allahverdy2","Aziza2","Emir2","Monya2","Aeka2","Bayan2","Arai2","Jury2","Jury1","Meyirim2"];
const WORKER_URL="https://shiny-tree-f78c.aiko030500.workers.dev";
let DAILY_LIMIT=3,usedToday=Number(localStorage.getItem("usedToday"))||0,lastDate=localStorage.getItem("lastDate"),today=new Date().toDateString(),isTeacher=localStorage.getItem("isTeacher")==="true";
if(lastDate!==today){usedToday=0;localStorage.setItem("lastDate",today);localStorage.setItem("usedToday",0);}
function updateCounter(){const c=document.getElementById("limitCounter");if(!c)return;c.innerHTML=isTeacher?"ğŸ‘©â€ğŸ« Teacher mode: unlimited questions":`â­ ${3-usedToday} of 3 questions left today`;}
function checkLogin(){const n=document.getElementById("nameInput").value.trim().toLowerCase(),p=document.getElementById("pinInput").value.trim(),a=allowedNames.map(x=>x.toLowerCase());if(a.includes(n)&&p==="6856"){localStorage.setItem("currentStudent",n);localStorage.removeItem("isTeacher");document.getElementById("loginOverlay").style.display="none";document.getElementById("mainMenu").style.display="block";document.getElementById("welcomeBox").style.display="block";document.getElementById("welcomeText").innerText="Hello, "+n+"!";updateCounter();}else if(n==="teacher"&&p==="1402"){localStorage.setItem("isTeacher","true");isTeacher=true;document.body.classList.add("teacher-mode");document.getElementById("teacherBanner").style.display="block";document.getElementById("loginOverlay").style.display="none";document.getElementById("mainMenu").style.display="block";}else alert("âŒ Wrong name or PIN");}
function openTheme(n){window.location.href="theme"+n+".html";}
function openChat(){document.getElementById("mainMenu").style.display="none";document.getElementById("chatSection").style.display="block";updateCounter();}
function openTeacherJournal(){document.getElementById("mainMenu").style.display="none";document.getElementById("teacherJournal").style.display="block";buildJournal();}
function backMenu(){document.getElementById("teacherJournal").style.display="none";document.getElementById("chatSection").style.display="none";document.getElementById("mainMenu").style.display="block";}
function buildJournal(){const b=document.getElementById("journalBody");b.innerHTML="";allowedNames.forEach(n=>{let t=0;for(let i=1;i<=13;i++)t+=Number(localStorage.getItem(n+"_lesson"+i+"Stars"))||0;const c=Number(localStorage.getItem(n+"_chatStars"))||0;t+=c;b.innerHTML+=`<tr><td>${n}</td><td>${t-c}</td><td>${c}</td><td>${t}</td></tr>`;});}
updateCounter();
</script>
</body>
</html>
