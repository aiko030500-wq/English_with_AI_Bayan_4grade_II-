<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English with AI Bayan 4grade II (Online)</title>
<style>
  body {
    font-family: Verdana, sans-serif;
    background: linear-gradient(180deg,#fff6e5 0%,#f3e0b8 100%);
    margin: 0;
    color: #002b5c;
    text-align: center;
  }
  header {
    background: #003366;
    color: white;
    padding: 1rem;
    border-bottom: 5px solid gold;
  }
  main { padding: 1rem; }

  .btn {
    display: inline-block;
    margin: 6px;
    padding: 8px 14px;
    border-radius: 10px;
    border: none;
    background: #003366;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
    font-size: 0.9rem;
  }
  .btn:hover { background: gold; color: #003366; }

  .overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.55);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 999;
  }
  .overlay-card {
    background: white;
    padding: 20px;
    border-radius: 16px;
    width: 90%;
    max-width: 400px;
    box-shadow: 0 0 15px rgba(0,0,0,0.3);
    border: 4px solid gold;
  }
  .overlay-card input {
    width: 100%;
    padding: 8px;
    margin: 6px 0;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 1rem;
  }

  .logo-main {
    width: 120px;
    height: 120px;
    object-fit: cover;
    border-radius: 50%;
    border: 3px solid gold;
    margin-bottom: 6px;
  }

  .topics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(180px,1fr));
    gap: 10px;
    max-width: 900px;
    margin: 0 auto 15px;
  }
  .topic-card {
    background: #ffffff;
    border-radius: 16px;
    padding: 12px;
    box-shadow: 0 0 8px rgba(0,0,0,0.08);
    cursor: pointer;
    border: 2px solid #dde6ff;
    font-size: 0.95rem;
  }
  .topic-card:hover {
    border-color: gold;
    transform: translateY(-1px);
  }

  #welcomeBox {
    background: linear-gradient(180deg,#fff9ec 0%,#f8e4ba 100%);
    border: 3px solid gold;
    border-radius: 20px;
    padding: 16px;
    width: 90%;
    max-width: 600px;
    margin: 16px auto 20px;
    box-shadow: 0 0 15px rgba(255,215,0,0.4);
  }
  #welcomeBox h2 { margin: 4px 0; font-size: 1.4rem; }
  #totalStars { font-weight: bold; color:#d48a00; }

  .section {
    display: none;
    margin-top: 16px;
  }

  table {
    font-size: 0.85rem;
  }
  th, td {
    padding: 4px 6px;
  }
</style>
</head>
<body>

<!-- üîê LOGIN -->
<div class="overlay" id="loginOverlay">
  <div class="overlay-card">
    <h1>English with AI Bayan</h1>
    <input type="text" id="nameInput" placeholder="Enter your name">
    <input type="password" id="pinInput" placeholder="Enter PIN" maxlength="4">
    <button class="btn" onclick="checkLogin()">Enter</button>
  </div>
</div>

<header>
  <h1>English with AI Bayan 4grade II (ONLINE)</h1>
</header>

<main>
  <!-- üëã Welcome box -->
  <div id="welcomeBox" style="display:none;">
    <img src="logo.png" alt="AI Bayan Logo" class="logo-main">
    <h2 id="welcomeText"></h2>
    <p>You have <span id="totalStars">0</span> ‚≠ê total stars!</p>
  </div>

  <!-- üßí Student menu -->
  <div id="studentMenu" style="display:none;">
    <div class="topics-grid">
      <div class="topic-card" onclick="openLesson(1)">1. üé® Let‚Äôs Have Fun!</div>
      <div class="topic-card" onclick="openLesson(2)">2. üèÉ Sports and Exercises</div>
      <div class="topic-card" onclick="openLesson(3)">3. üåç Sports Around the World</div>
      <div class="topic-card" onclick="openLesson(4)">4. üéµ Arts and Music</div>
      <div class="topic-card" onclick="openLesson(5)">5. ‚öΩ Popular Team Sports</div>
      <div class="topic-card" onclick="openLesson(6)">6. üéª Museum of Kazakh Musical Instruments</div>
      <div class="topic-card" onclick="openLesson(7)">7. üìú Children‚Äôs Rights & Responsibilities</div>
      <div class="topic-card" onclick="openLesson(8)">8. üß∞ Different Jobs</div>
      <div class="topic-card" onclick="openLesson(9)">9. üë©‚Äç‚öïÔ∏è Professions</div>
      <div class="topic-card" onclick="openLesson(10)">10. üè¢ People at Work</div>
      <div class="topic-card" onclick="openLesson(11)">11. üí¨ What Do You Do?</div>
      <div class="topic-card" onclick="openLesson(12)">12. ‚ù§Ô∏è You Can Help!</div>
      <div class="topic-card" onclick="openLesson(13)">13. üéØ Final Challenge</div>
      <div class="topic-card" onclick="openChatSection()">
        üí¨ AI Bayan Chat ‚Äî Ask the Teacher ü§ñ
      </div>
    </div>
    <button class="btn" onclick="openTeacherJournal()">üè´ Teacher Journal</button>
  </div>

  <!-- üè´ Teacher Journal -->
  <div id="teacherJournal" class="section">
    <h2>üè´ Teacher Journal</h2>
    <table border="1" cellpadding="4" cellspacing="0" style="margin:auto;border-collapse:collapse;">
      <thead>
        <tr>
          <th>Student</th>
          <th>L1</th><th>L2</th><th>L3</th><th>L4</th><th>L5</th><th>L6</th>
          <th>L7</th><th>L8</th><th>L9</th><th>L10</th><th>L11</th><th>L12</th><th>L13</th>
          <th>Chat</th>
          <th>Total ‚≠ê</th>
        </tr>
      </thead>
      <tbody id="journalBody"></tbody>
    </table>
    <button class="btn" onclick="logout()">Logout</button>
  </div>

  <!-- üí¨ AI Bayan ONLINE CHAT -->
  <section id="chatSection" class="section" style="max-width:900px;margin:0 auto;">
    <h2>üí¨ AI Bayan ‚Äî Online Teacher Chat</h2>
    <p>Ask about <b>grammar, vocabulary, translation or homework</b>.<br>
       You can write in English or Russian.</p>

    <div id="chatBox"
         style="max-height:320px;overflow-y:auto;border:1px solid #ccc;
                padding:10px;border-radius:10px;background:#fff;
                text-align:left;font-size:0.9rem;"></div>

    <textarea id="chatInput"
              placeholder="Type your question here..."
              style="width:100%;border-radius:8px;margin-top:8px;min-height:60px;"></textarea><br>

    <button class="btn" onclick="askBayan()">Ask AI Bayan</button>
    <button class="btn" onclick="clearChat()">Clear</button>
    <button class="btn" onclick="goMenu()">üè† Back to Menu</button>
  </section>
</main>

<script>
// ‚úÖ –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ (–∞–Ω–≥–ª. –≤–∞—Ä–∏–∞–Ω—Ç)
const allowedNames = [
  "Aylin2","Aitach2","Zhakhangir2","Alvi2","Narmin2","Balman2",
  "Dima2","Ilyas2","Kirill2","Irada2","Shyngys2","Sultan2",
  "Kira2","Damir2","Arai2","Bayan2","Jury2","Jury3"
];

// üîê –≤—Ö–æ–¥ –ø–æ –∏–º–µ–Ω–∏ + PIN
function checkLogin(){
  const name = document.getElementById("nameInput").value.trim();
  const pin  = document.getElementById("pinInput").value.trim();

  // —É—á–µ–Ω–∏–∫
  if(allowedNames.includes(name) && pin === "6856"){
    localStorage.setItem("currentStudent", name);
    document.getElementById("loginOverlay").style.display = "none";
    document.getElementById("studentMenu").style.display   = "block";
    document.getElementById("welcomeBox").style.display    = "block";
    document.getElementById("welcomeText").innerText = "Hello, " + name + "!";
    updateStars();
  }
  // —É—á–∏—Ç–µ–ª—å
  else if(name.toLowerCase() === "teacher" && pin === "9995"){
    document.getElementById("loginOverlay").style.display = "none";
    document.getElementById("teacherJournal").style.display = "block";
    buildJournal();
  }
  else {
    alert("‚ùå Access denied. Check your name or PIN.");
  }
}

// ‚≠ê –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–≤—ë–∑–¥ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —É—á–µ–Ω–∏–∫–∞
function updateStars(){
  const name = localStorage.getItem("currentStudent");
  if(!name) return;
  let total = 0;
  for(let i=1;i<=13;i++){
    total += Number(localStorage.getItem(name+"_lesson"+i+"Stars")) || 0;
  }
  total += Number(localStorage.getItem(name+"_chatStars")) || 0;
  document.getElementById("totalStars").innerText = total;
  // –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—â–∏–π –∏—Ç–æ–≥ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª—é—á
  localStorage.setItem(name+"_totalStars", total);
}

// üè´ Teacher Journal ‚Äì –∑–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É
function buildJournal(){
  const body = document.getElementById("journalBody");
  body.innerHTML = "";
  allowedNames.forEach(name=>{
    let row = "<tr><td>"+name+"</td>";
    let total = 0;
    for(let i=1;i<=13;i++){
      const stars = Number(localStorage.getItem(name+"_lesson"+i+"Stars")) || 0;
      total += stars;
      row += "<td>"+stars+"</td>";
    }
    const chatStars = Number(localStorage.getItem(name+"_chatStars")) || 0;
    total += chatStars;
    row += "<td>"+chatStars+"</td>";
    row += "<td>"+total+"</td></tr>";
    body.innerHTML += row;
  });
}

// –æ—Ç–∫—Ä—ã—Ç—å —Ç–µ–º—É
function openLesson(n){
  window.location.href = "theme"+n+".html";
}

// –æ—Ç–∫—Ä—ã—Ç—å –∂—É—Ä–Ω–∞–ª –∏–∑ –º–µ–Ω—é —É—á–µ–Ω–∏–∫–∞
function openTeacherJournal(){
  document.getElementById("studentMenu").style.display   = "none";
  document.getElementById("teacherJournal").style.display = "block";
  buildJournal();
}

// –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é
function goMenu(){
  window.location.href = "index.html";
}

// –≤—ã–π—Ç–∏
function logout(){
  localStorage.removeItem("currentStudent");
  window.location.href = "index.html";
}

// üí¨ –æ—Ç–∫—Ä—ã—Ç—å —á–∞—Ç
function openChatSection(){
  document.getElementById("studentMenu").style.display = "none";
  document.getElementById("teacherJournal").style.display = "none";
  document.getElementById("chatSection").style.display = "block";
}

// ================== ü§ñ AI BAYAN ONLINE CHAT ==================

// ‚ö†Ô∏è –¢–£–¢ –ù–£–ñ–ï–ù –¢–í–û–ô –ö–õ–Æ–ß OPENAI (–ù–ï –ö–õ–ê–î–ò –° –≠–¢–ò–ú –§–ê–ô–õ–û–ú –ù–ê –û–¢–ö–†–´–¢–´–ô GITHUB!)
const OPENAI_API_KEY = "YOUR_OPENAI_API_KEY_HERE";

async function askBayan(){
  const input = document.getElementById('chatInput');
  const box   = document.getElementById('chatBox');
  const question = input.value.trim();

  if(!question){
    alert("Type your question first.");
    return;
  }

  box.innerHTML += `<p><b>You:</b> ${question}</p>`;
  box.innerHTML += `<p id="thinking"><i>AI Bayan is thinking...</i></p>`;
  box.scrollTop = box.scrollHeight;
  input.value = "";

  try {
    const response = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer " + sk-proj-MntsizlNtW
      },
      body: JSON.stringify({
        model: "gpt-4.1-mini",
        messages: [
          {
            role: "system",
            content: "You are AI Bayan, a kind English teacher for 4th grade kids in Kazakhstan. Explain in simple English, add short Russian help if needed, be very clear and friendly."
          },
          { role: "user", content: question }
        ]
      })
    });

    const data = await response.json();
    const answer = data.choices?.[0]?.message?.content || "Sorry, I cannot answer right now.";

    const thinking = document.getElementById("thinking");
    if(thinking) thinking.remove();

    box.innerHTML += `<p><b>AI Bayan:</b> ${answer}</p>`;
    box.scrollTop = box.scrollHeight;

    // –º–æ–∂–Ω–æ –æ–∑–≤—É—á–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç
    bayanSpeak(answer);

    // +1 –∑–≤–µ–∑–¥–∞ –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —á–∞—Ç–µ
    const name = localStorage.getItem("currentStudent");
    if(name){
      let chatStars = Number(localStorage.getItem(name+"_chatStars")) || 0;
      chatStars++;
      localStorage.setItem(name+"_chatStars", chatStars);
      updateStars();
    }

  } catch(err){
    const thinking = document.getElementById("thinking");
    if(thinking) thinking.remove();
    box.innerHTML += `<p><b>AI Bayan:</b> Sorry, there was an error connecting to the server.</p>`;
    console.error(err);
  }
}

function clearChat(){
  document.getElementById('chatBox').innerHTML = "";
}

// üéôÔ∏è –º—è–≥–∫–∏–π –≥–æ–ª–æ—Å AI Bayan
function bayanSpeak(text){
  const speakNow = () => {
    const voices = speechSynthesis.getVoices();
    let voice = voices.find(v =>
      v.name.includes("Google UK English Female") ||
      v.name.includes("Microsoft Sonia Online") ||
      v.lang === "en-GB"
    );
    if(!voice) voice = voices[0];

    const utter = new SpeechSynthesisUtterance(text);
    utter.voice  = voice;
    utter.lang   = "en-GB";
    utter.rate   = 0.9;
    utter.pitch  = 1.0;
    utter.volume = 1.0;
    speechSynthesis.speak(utter);
  };

  if(speechSynthesis.getVoices().length === 0){
    speechSynthesis.onvoiceschanged = speakNow;
  } else {
    speakNow();
  }
}
</script>...
<script src="animations.js"></script>
  <style>
  .result-icon {
    font-size: 2.5rem;
    opacity: 0;
    transition: opacity 0.4s ease, transform 0.4s ease;
    transform: scale(0.5);
    position: fixed;
    top: 45%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.5);
    z-index: 9999;
  }
  .result-icon.show {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  .correct {
    color: #4CAF50; /* –∑–µ–ª—ë–Ω–∞—è –≥–∞–ª–æ—á–∫–∞ */
  }
  .wrong {
    color: #e53935; /* –∫—Ä–∞—Å–Ω—ã–π –∫—Ä–µ—Å—Ç–∏–∫ */
  }
</style>

<div id="feedbackIcon" class="result-icon"></div>

<script>
function showResult(isCorrect) {
  const icon = document.getElementById("feedbackIcon");
  if (isCorrect) {
    icon.textContent = "‚úî";
    icon.className = "result-icon correct show";
  } else {
    icon.textContent = "‚úñ";
    icon.className = "result-icon wrong show";
  }
  setTimeout(() => {
    icon.classList.remove("show");
  }, 800);
}
</script>
  <!-- ‚úÖ –ê–Ω–∏–º–∞—Ü–∏—è –≥–∞–ª–æ—á–∫–∏ –∏ –∫—Ä–µ—Å—Ç–∏–∫–∞ -->
<style>
  .result-icon {
    font-size: 3rem;
    opacity: 0;
    transform: scale(0.5);
    transition: opacity 0.4s ease, transform 0.4s ease;
    position: fixed;
    top: 45%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.5);
    z-index: 9999;
    pointer-events: none;
  }
  .result-icon.show {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  .correct {
    color: #00c853; /* —è—Ä–∫–æ-–∑–µ–ª—ë–Ω–∞—è –≥–∞–ª–æ—á–∫–∞ */
    text-shadow: 0 0 15px #7fff8c;
  }
  .wrong {
    color: #ff1744; /* –∫—Ä–∞—Å–Ω—ã–π –∫—Ä–µ—Å—Ç–∏–∫ */
    text-shadow: 0 0 15px #ff7f7f;
  }
</style>

<!-- –ò–∫–æ–Ω–∫–∞ (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–≤–µ—Ç–∞—Ö) -->
<div id="feedbackIcon" class="result-icon"></div>

<script>
  // üéØ –ø–æ–∫–∞–∑–∞—Ç—å –≥–∞–ª–æ—á–∫—É –∏–ª–∏ –∫—Ä–µ—Å—Ç–∏–∫
  function showResult(isCorrect) {
    const icon = document.getElementById("feedbackIcon");
    if (isCorrect) {
      icon.textContent = "‚úî";
      icon.className = "result-icon correct show";
    } else {
      icon.textContent = "‚úñ";
      icon.className = "result-icon wrong show";
    }
    // —á–µ—Ä–µ–∑ 0.9 —Å–µ–∫ —Å–∫—Ä—ã—Ç—å
    setTimeout(() => {
      icon.classList.remove("show");
    }, 900);
  }
</script>
  <button onclick="showResult(true)">‚úî Test Correct</button>
<button onclick="showResult(false)">‚úñ Test Wrong</button>
</body>
</html>
